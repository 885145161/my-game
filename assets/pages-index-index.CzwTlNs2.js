import{g as e,c as t,s,a as i,w as l,i as h,o as a,b as r,d as o,t as n,e as c,f as d,h as u,j as y}from"./index-BwcsSbWU.js";const p=((e,t)=>{const s=e.__vccOpts||e;for(const[i,l]of t)s[i]=l;return s})({data:()=>({ctx:null,screenWidth:0,screenHeight:0,isPlaying:!1,gameOver:!1,score:0,timer:null,coins:100,isDoubleFire:!1,doubleFireTimer:null,player:{x:0,y:0,width:40,height:40,color:"#00ff00"},bullets:[],enemies:[],enemyBullets:[],frameCount:0}),onReady(){const s=e();this.screenWidth=s.windowWidth,this.screenHeight=s.windowHeight,this.player.x=this.screenWidth/2-20,this.player.y=this.screenHeight-100,this.ctx=t("gameCanvas",this),this.draw()},methods:{startGame(){this.isPlaying=!0,this.gameOver=!1,this.score=0,this.coins=100,this.isDoubleFire=!1,clearInterval(this.doubleFireTimer),this.bullets=[],this.enemies=[],this.enemyBullets=[],this.frameCount=0,clearInterval(this.timer),this.timer=setInterval(this.gameLoop,30)},restartGame(){this.startGame()},gameLoop(){if(this.isPlaying){if(this.frameCount++,this.frameCount%10==0&&(this.bullets.push({x:this.player.x+this.player.width/2,y:this.player.y,radius:4,speed:10,type:"player"}),this.isDoubleFire&&(this.bullets.push({x:this.player.x+this.player.width/4,y:this.player.y+10,radius:4,speed:10,type:"player"}),this.bullets.push({x:this.player.x+3*this.player.width/4,y:this.player.y+10,radius:4,speed:10,type:"player"}))),this.frameCount%40==0){const e=30+20*Math.random();this.enemies.push({x:Math.random()*(this.screenWidth-e),y:-e,width:e,height:e,speed:2+3*Math.random(),hp:1,shootCounter:Math.floor(100*Math.random())})}for(let e=this.bullets.length-1;e>=0;e--){const t=this.bullets[e];t.y-=t.speed,t.y<0&&this.bullets.splice(e,1)}for(let e=this.enemyBullets.length-1;e>=0;e--){const t=this.enemyBullets[e];if(t.y+=t.speed,this.checkCollision(this.player,t,!0))return void this.endGame();t.y>this.screenHeight&&this.enemyBullets.splice(e,1)}for(let e=this.enemies.length-1;e>=0;e--){const t=this.enemies[e];if(t.y+=t.speed,t.shootCounter++,t.shootCounter%150==0&&t.y>0&&t.y<this.screenHeight-100&&this.enemyBullets.push({x:t.x+t.width/2,y:t.y+t.height,radius:3,speed:5,type:"enemy"}),this.checkRectCollision(this.player,t))return void this.endGame();if(t.y>this.screenHeight)this.enemies.splice(e,1);else for(let s=this.bullets.length-1;s>=0;s--){const i=this.bullets[s];if(i.x>t.x&&i.x<t.x+t.width&&i.y>t.y&&i.y<t.y+t.height){this.enemies.splice(e,1),this.bullets.splice(s,1);const t=this.score;this.score+=10,Math.floor(this.score/100)>Math.floor(t/100)&&this.coins++;break}}}this.draw()}},draw(){const e=this.ctx;e.setFillStyle("#1a1a1a"),e.fillRect(0,0,this.screenWidth,this.screenHeight),this.isPlaying&&(e.beginPath(),e.moveTo(this.player.x+this.player.width/2,this.player.y),e.lineTo(this.player.x+this.player.width,this.player.y+this.player.height),e.lineTo(this.player.x,this.player.y+this.player.height),e.closePath(),e.setFillStyle("#4cd964"),e.fill(),e.setFillStyle("#f0ad4e"),this.bullets.forEach((t=>{e.beginPath(),e.arc(t.x,t.y,t.radius,0,2*Math.PI),e.fill()})),e.setFillStyle("#ffffff"),this.enemyBullets.forEach((t=>{e.beginPath(),e.arc(t.x,t.y,t.radius,0,2*Math.PI),e.fill()})),e.setFillStyle("#dd524d"),this.enemies.forEach((t=>{e.fillRect(t.x,t.y,t.width,t.height)}))),e.draw()},handleTouchMove(e){if(!this.isPlaying)return;let t=e.touches[0];this.player.x=t.x-this.player.width/2,this.player.y=t.y-this.player.height/2},buyUpgrade(){this.coins<50?s({title:"金币不足！",icon:"none"}):this.isDoubleFire?s({title:"双倍火力已激活",icon:"none"}):(this.coins-=50,this.isDoubleFire=!0,s({title:"双倍火力激活 (10秒)",icon:"success"}),clearTimeout(this.doubleFireTimer),this.doubleFireTimer=setTimeout((()=>{this.isDoubleFire=!1,s({title:"双倍火力结束",icon:"none"})}),1e4))},checkRectCollision:(e,t)=>e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y,checkCollision(e,t,s){if(s){const s=e.x+e.width/2,i=e.y+e.height/2,l=s-t.x,h=i-t.y;return Math.sqrt(l*l+h*h)<e.width/2+2*t.radius}return this.checkRectCollision(e,t)},endGame(){this.isPlaying=!1,this.gameOver=!0,clearInterval(this.timer),clearTimeout(this.doubleFireTimer)},handleTouchStart(){},handleTouchEnd(){}}},[["render",function(e,t,s,p,m,f){const g=d,b=h,x=u,v=y;return a(),i(b,{class:"container"},{default:l((()=>[r(g,{"canvas-id":"gameCanvas",id:"gameCanvas",class:"game-canvas",onTouchstart:f.handleTouchStart,onTouchmove:f.handleTouchMove,onTouchend:f.handleTouchEnd},null,8,["onTouchstart","onTouchmove","onTouchend"]),r(b,{class:"ui-layer"},{default:l((()=>[r(b,{class:"top-bar"},{default:l((()=>[r(b,{class:"score"},{default:l((()=>[o("分数: "+n(m.score),1)])),_:1}),r(b,{class:"coins"},{default:l((()=>[o("金币: "+n(m.coins),1)])),_:1})])),_:1}),r(b,{class:"shop-btn-container"},{default:l((()=>[r(x,{class:"shop-btn",onClick:f.buyUpgrade,disabled:!m.isPlaying||m.isDoubleFire||m.coins<50},{default:l((()=>[o(" 双倍火力 (50金币) ")])),_:1},8,["onClick","disabled"]),m.isDoubleFire?(a(),i(b,{key:0,class:"upgrade-status"},{default:l((()=>[o(" 火力翻倍中... ")])),_:1})):c("",!0)])),_:1}),m.gameOver?(a(),i(b,{key:0,class:"game-over-modal"},{default:l((()=>[r(v,{class:"game-over-text"},{default:l((()=>[o("游戏结束")])),_:1}),r(v,{class:"final-score"},{default:l((()=>[o("最终得分: "+n(m.score),1)])),_:1}),r(x,{class:"restart-btn",onClick:f.restartGame},{default:l((()=>[o("重新开始")])),_:1},8,["onClick"])])),_:1})):c("",!0),m.isPlaying||m.gameOver?c("",!0):(a(),i(b,{key:1,class:"start-modal"},{default:l((()=>[r(v,{class:"title"},{default:l((()=>[o("雷霆战机")])),_:1}),r(x,{class:"start-btn",onClick:f.startGame},{default:l((()=>[o("开始游戏")])),_:1},8,["onClick"]),r(v,{class:"tip"},{default:l((()=>[o("手指拖动飞机移动，自动射击")])),_:1})])),_:1}))])),_:1})])),_:1})}],["__scopeId","data-v-a67e6c94"]]);export{p as default};
